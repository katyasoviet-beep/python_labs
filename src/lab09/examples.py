from src.lab09.group import Group
from src.lab08.models import Student


# –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –≥—Ä—É–ø–ø—ã
group = Group("data/lab09/students.csv")


# ===================================================================
# 1. list() ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
# ===================================================================
print("üìã –í—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã:")
students = group.list()
for s in students:
    print(f"  {s.fio} | –ì—Ä—É–ø–ø–∞: {s.group} | GPA: {s.gpa}")
print("-" * 60)


# ===================================================================
# 2. find(substr) ‚Äî –ø–æ–∏—Å–∫ –ø–æ –§–ò–û
# ===================================================================
print("üîç –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å '–∞–Ω–Ω–∞':")
found = group.find("–∞–Ω–Ω–∞")
for s in found:
    print(f"  {s.fio} ‚Äî {s.gpa}")
print("-" * 60)


# ===================================================================
# 3. add(student) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
# ===================================================================
new_student = Student(
    fio="–°–º–∏—Ä–Ω–æ–≤–∞ –û–ª—å–≥–∞ –ü–∞–≤–ª–æ–≤–Ω–∞",
    birthdate="2000/08/12",
    group="SE-02",
    gpa=4.7
)
group.add(new_student)
print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω: {new_student.fio}")
print("-" * 60)


# ===================================================================
# 4. update(fio, **fields) ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
# ===================================================================
print("üîÑ –û–±–Ω–æ–≤–ª—è–µ–º GPA –ò–≤–∞–Ω–æ–≤–∞ –ò–≤–∞–Ω–∞ –ò–≤–∞–Ω–æ–≤–∏—á–∞ –¥–æ 5.0")
group.update("–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", gpa=5.0)
print("-" * 60)


# ===================================================================
# 5. find() –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
# ===================================================================
print("üîç –ü—Ä–æ–≤–µ—Ä–∏–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ GPA —É –ò–≤–∞–Ω–æ–≤–∞:")
ivanov = group.find("–ò–≤–∞–Ω–æ–≤")[0]
print(f"  {ivanov.fio} ‚Äî {ivanov.gpa}")
print("-" * 60)


# ===================================================================
# 6. remove(fio) ‚Äî —É–¥–∞–ª–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞
# ===================================================================
print("üóëÔ∏è –£–¥–∞–ª—è–µ–º –ù–∏–∫–∏—Ç–∏–Ω–∞ –ü–∞–≤–ª–∞ –°—Ç–∞–Ω–∏—Å–ª–∞–≤–æ–≤–∏—á–∞")
try:
    group.remove("–ù–∏–∫–∏—Ç–∏–Ω –ü–∞–≤–µ–ª –°—Ç–∞–Ω–∏—Å–ª–∞–≤–æ–≤–∏—á")
    print("‚úÖ –£–¥–∞–ª—ë–Ω")
except ValueError as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
print("-" * 60)


# ===================================================================
# 7. stats() ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
# ===================================================================
print("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥—Ä—É–ø–ø–µ:")
stats = group.stats()

print(f"–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {stats['count']}")
print(f"–ú–∏–Ω. GPA: {stats['min_gpa']}, –ú–∞–∫—Å. GPA: {stats['max_gpa']}, –°—Ä–µ–¥–Ω–∏–π: {stats['avg_gpa']}")
print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º:")
for gr, count in stats['groups'].items():
    print(f"  {gr}: {count}")

print("üèÜ –¢–æ–ø-5 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
for i, s in enumerate(stats['top_5_students'], 1):
    print(f"  {i}. {s['fio']} ‚Äî {s['gpa']}")
print("-" * 60)


# ===================================================================
# 8. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π list() ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
# ===================================================================
print("üîÅ –ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:")
for s in group.list():
    print(f"  {s.fio} | {s.group} | {s.gpa}")
